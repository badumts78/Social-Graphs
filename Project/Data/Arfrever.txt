issue
Test failures with Python 3.3#TITLE_END#Test suite of Networkx sometimes fails with Python 3.3 due to hash randomization, which is enabled by default in Python >=3.3. It might be necessary to run test suite multiple times to reproduce this bug.  ``` ====================================================================== FAIL: Doctest: networkx.convert.from_numpy_matrix ---------------------------------------------------------------------- Traceback (most recent call last):   File "/usr/lib64/python3.3/doctest.py", line 2154, in runTest     raise self.failureException(self.format_failure(new.getvalue())) nose.proxy.AssertionError: Failed doctest test for networkx.convert.from_numpy_matrix   File "/tmp/networkx/networkx/convert.py", line 531, in from_numpy_matrix  ---------------------------------------------------------------------- File "/tmp/networkx/networkx/convert.py", line 571, in networkx.convert.from_numpy_matrix Failed example:     G.edges(data=True) Expected:     [(0, 0, {'cost': 2, 'weight': 1.0})] Got:     [(0, 0, {'weight': 1.0, 'cost': 2})]  >>  raise self.failureException(self.format_failure(<_io.StringIO object at 0x7fe6a64dd050>.getvalue()))   ====================================================================== FAIL: test_misc.TestNumpyArray.test_dict_to_numpy_array ---------------------------------------------------------------------- Traceback (most recent call last):   File "/usr/lib64/python3.3/site-packages/nose/case.py", line 198, in runTest     self.test(*self.arg)   File "/tmp/networkx/networkx/utils/tests/test_misc.py", line 69, in test_dict_to_numpy_array     assert_equal(a, numpy.array([[1,2],[10,20]]))   File "/usr/lib64/python3.3/site-packages/numpy/testing/utils.py", line 260, in assert_equal     return assert_array_equal(actual, desired, err_msg, verbose)   File "/usr/lib64/python3.3/site-packages/numpy/testing/utils.py", line 718, in assert_array_equal     verbose=verbose, header='Arrays are not equal')   File "/usr/lib64/python3.3/site-packages/numpy/testing/utils.py", line 644, in assert_array_compare     raise AssertionError(msg) nose.proxy.AssertionError:  Arrays are not equal  (mismatch 100.0%)  x: array([[ 20.,  10.],        [  2.,   1.]])  y: array([[ 1,  2],        [10, 20]]) >>  raise AssertionError('\nArrays are not equal\n\n(mismatch 100.0%)\n x: array([[ 20.,  10.],\n       [  2.,   1.]])\n y: array([[ 1,  2],\n       [10, 20]])')   ====================================================================== FAIL: test_misc.TestNumpyArray.test_dict_to_numpy_array1 ---------------------------------------------------------------------- Traceback (most recent call last):   File "/usr/lib64/python3.3/site-packages/nose/case.py", line 198, in runTest     self.test(*self.arg)   File "/tmp/networkx/networkx/utils/tests/test_misc.py", line 52, in test_dict_to_numpy_array1     assert_equal(a, numpy.array([1,2]))   File "/usr/lib64/python3.3/site-packages/numpy/testing/utils.py", line 260, in assert_equal     return assert_array_equal(actual, desired, err_msg, verbose)   File "/usr/lib64/python3.3/site-packages/numpy/testing/utils.py", line 718, in assert_array_equal     verbose=verbose, header='Arrays are not equal')   File "/usr/lib64/python3.3/site-packages/numpy/testing/utils.py", line 644, in assert_array_compare     raise AssertionError(msg) nose.proxy.AssertionError: Arrays are not equal  (mismatch 100.0%)  x: array([ 2.,  1.])  y: array([1, 2]) >>  raise AssertionError('\nArrays are not equal\n\n(mismatch 100.0%)\n x: array([ 2.,  1.])\n y: array([1, 2])')   ====================================================================== FAIL: test_misc.TestNumpyArray.test_dict_to_numpy_array2 ---------------------------------------------------------------------- Traceback (most recent call last):   File "/usr/lib64/python3.3/site-packages/nose/case.py", line 198, in runTest     self.test(*self.arg)   File "/tmp/networkx/networkx/utils/tests/test_misc.py", line 60, in test_dict_to_numpy_array2     assert_equal(a, numpy.array([[1,2],[10,20]]))   File "/usr/lib64/python3.3/site-packages/numpy/testing/utils.py", line 260, in assert_equal     return assert_array_equal(actual, desired, err_msg, verbose)   File "/usr/lib64/python3.3/site-packages/numpy/testing/utils.py", line 718, in assert_array_equal     verbose=verbose, header='Arrays are not equal')   File "/usr/lib64/python3.3/site-packages/numpy/testing/utils.py", line 644, in assert_array_compare     raise AssertionError(msg) nose.proxy.AssertionError:  Arrays are not equal  (mismatch 100.0%)  x: array([[ 20.,  10.],        [  2.,   1.]])  y: array([[ 1,  2],        [10, 20]]) >>  raise AssertionError('\nArrays are not equal\n\n(mismatch 100.0%)\n x: array([[ 20.,  10.],\n       [  2.,   1.]])\n y: array([[ 1,  2],\n       [10, 20]])')   ---------------------------------------------------------------------- Ran 1830 tests in 46.437s  FAILED (SKIP=6, failures=4) ``` 
issue
Test failures with Python 3.1#TITLE_END#Test suite of Networkx has 1 error and 1 failure with Python 3.1. This problem does not occur in Python >=3.2.  ``` ====================================================================== ERROR: test_gexf.TestGEXF.test_write_with_node_attributes ---------------------------------------------------------------------- Traceback (most recent call last):   File "/usr/lib64/python3.1/site-packages/nose/case.py", line 198, in runTest     self.test(*self.arg)   File "/tmp/networkx/networkx/readwrite/tests/test_gexf.py", line 313, in test_write_with_node_attributes     obtained = '\n'.join(nx.generate_gexf(G))   File "/tmp/networkx/networkx/readwrite/gexf.py", line 119, in generate_gexf     for line in str(writer).splitlines():   File "/tmp/networkx/networkx/readwrite/gexf.py", line 276, in __str__     s=tostring(self.xml).decode(self.encoding) AttributeError: 'str' object has no attribute 'decode'  ====================================================================== FAIL: Doctest: networkx.readwrite.graphml.parse_graphml ---------------------------------------------------------------------- Traceback (most recent call last):   File "/usr/lib64/python3.1/doctest.py", line 2112, in runTest     raise self.failureException(self.format_failure(new.getvalue())) nose.proxy.AssertionError: Failed doctest test for networkx.readwrite.graphml.parse_graphml   File "/tmp/networkx/networkx/readwrite/graphml.py", line 157, in parse_graphml  ---------------------------------------------------------------------- File "/tmp/networkx/networkx/readwrite/graphml.py", line 180, in networkx.readwrite.graphml.parse_graphml Failed example:     s=linefeed.join(nx.generate_graphml(G)) Exception raised:     Traceback (most recent call last):       File "/usr/lib64/python3.1/doctest.py", line 1247, in __run         compileflags, 1), test.globs)       File "<doctest networkx.readwrite.graphml.parse_graphml[2]>", line 1, in <module>         s=linefeed.join(nx.generate_graphml(G))       File "/tmp/networkx/networkx/readwrite/graphml.py", line 112, in generate_graphml         for line in str(writer).splitlines():       File "/tmp/networkx/networkx/readwrite/graphml.py", line 252, in __str__         s=tostring(self.xml).decode(self.encoding)     AttributeError: 'str' object has no attribute 'decode' ---------------------------------------------------------------------- File "/tmp/networkx/networkx/readwrite/graphml.py", line 181, in networkx.readwrite.graphml.parse_graphml Failed example:     H=nx.parse_graphml(s) Exception raised:     Traceback (most recent call last):       File "/usr/lib64/python3.1/doctest.py", line 1247, in __run         compileflags, 1), test.globs)       File "<doctest networkx.readwrite.graphml.parse_graphml[3]>", line 1, in <module>         H=nx.parse_graphml(s)     NameError: name 's' is not defined  >>  raise self.failureException(self.format_failure(<_io.StringIO object at 0x9e8b7d0>.getvalue()))   ---------------------------------------------------------------------- Ran 1830 tests in 38.142s  FAILED (SKIP=6, errors=1, failures=1) ``` 
comment
I confirm that this patch works for failures in this file. 
