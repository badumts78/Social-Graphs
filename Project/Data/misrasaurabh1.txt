issue
‚ö°Ô∏è Speed up function `disjoint_union_all` by 89%#TITLE_END#### üìÑ 89% (0.89x) speedup for ***`disjoint_union_all` in `networkx/algorithms/operators/all.py`***  ‚è±Ô∏è Runtime :   **`168 milliseconds`**  **‚Üí** **`89.0 milliseconds`** (best of `42` runs) ### üìù Explanation and details  Here is an optimized version of your program.   Key improvements. - Avoid redundant set constructions: use efficient `seen_nodes` and check/disjoint update in a single step. - Construct the output graph only once, using the type/attributes of the first graph. - Use direct node and edge iterators to avoid listing all nodes/edges into memory. - Avoid `relabel_nodes`'s potentially O(n) dict copy for default/no-op cases. - For `disjoint_union_all`, precalculate the new node label mapping in linear time and relabel via a fast update. - Minimize attribute overwrites and dict operations. - Micro-optimizations in iteration and set handling.   All comments not appearing with changed code are preserved.    This version avoids unnecessary list and dict constructions, minimizes overhead, and keeps memory footprint low even for many/large graphs, especially in the `disjoint_union_all` function. All return values, including attributes and graph types, are as before.   ‚úÖ **Correctness verification report:**  | Test                        | Status            | | --------------------------- | ----------------- | | ‚öôÔ∏è Existing Unit Tests | ‚úÖ **51 Passed** | | üåÄ Generated Regression Tests | üîò **None Found** | | ‚è™ Replay Tests | ‚úÖ **142 Passed** | | üîé Concolic Coverage Tests | üîò **None Found** | |üìä Tests Coverage       | 100.0% | <details> <summary>‚öôÔ∏è Existing Unit Tests Details</summary>  ```python - test_all.py - test_text.py - test_tracer_py__replay_test_1.py ```  </details>   To edit these changes `git checkout codeflash/optimize-disjoint_union_all-mbs2c3pq` and push.  [![Codeflash](https://img.shields.io/badge/Optimized%20with-Codeflash-yellow?style=flat&color=%23ffc428&logo=data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDgwIiBoZWlnaHQ9ImF1dG8iIHZpZXdCb3g9IjAgMCA0ODAgMjgwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTI4Ni43IDAuMzc4NDE4SDIwMS43NTFMNTAuOTAxIDE0OC45MTFIMTM1Ljg1MUwwLjk2MDkzOCAyODEuOTk5SDk1LjQzNTJMMjgyLjMyNCA4OS45NjE2SDE5Ni4zNDVMMjg2LjcgMC4zNzg0MThaIiBmaWxsPSIjRkZDMDQzIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMzExLjYwNyAwLjM3ODkwNkwyNTguNTc4IDU0Ljk1MjZIMzc5LjU2N0w0MzIuMzM5IDAuMzc4OTA2SDMxMS42MDdaIiBmaWxsPSIjMEIwQTBBIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMzA5LjU0NyA4OS45NjAxTDI1Ni41MTggMTQ0LjI3NkgzNzcuNTA2TDQzMC4wMjEgODkuNzAyNkgzMDkuNTQ3Vjg5Ljk2MDFaIiBmaWxsPSIjMEIwQTBBIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMjQyLjg3MyAxNjQuNjZMMTg5Ljg0NCAyMTkuMjM0SDMxMC44MzNMMzYzLjM0NyAxNjQuNjZIMjQyLjg3M1oiIGZpbGw9IiMwQjBBMEEiLz4KPC9zdmc+Cg==)](https://codeflash.ai)
