issue
Issue in minimum_cut#TITLE_END#Dear developers,  I experienced a numerical issue with the minimum_cut function, but was able to find a workaround.   ### Current Behavior Very rarely, the computed minimum cut is not minimum. In this case, residual arc capacities very close to 0 occur, due to numerical issues in floating-point arithmetic. The minimum cut function does currently not account for this.  line 460 of maxflow.py is `cutset = [(u, v, d) for u, v, d in R.edges(data=True) if d["flow"] == d["capacity"]]` when I manually replace it by `cutset = [(u, v, d) for u, v, d in R.edges(data=True) if abs(d["flow"] - d["capacity"]) < 1e-10]` everything works fine.  ### Steps to Reproduce Sorry for the non-minimal instance, it is already condensed ;-) ``` import networkx as nx  ################## capacities = [     (0, 13, 0.7085828890943541), (0, 1, 0.854291444547177), (1, 13, 0.07285427772641151), (2, 0, 1), (2, 1, 1),     (2, 13, 1), (3, 0, 1), (4, 17, 1.0), (5, 6, 1), (5, 7, 1), (6, 5, 0.14570855545282302), (6, 12, 1),     (7, 5, 0.854291444547177), (7, 8, 1), (8, 7, 0.854291444547177), (8, 9, 1), (9, 8, 0.854291444547177),     (9, 13, 1), (9, 14, 1), (10, 6, 0.07285427772641148), (10, 12, 1), (11, 21, 1), (11, 12, 1),     (12, 6, 0.07285427772641148), (12, 10, 0.07285427772641148), (12, 11, 1), (13, 1, 0.07285427772641151),     (13, 9, 1), (13, 14, 1), (14, 9, 0.7571524075786283), (15, 3, 0.854291444547177), (16, 15, 0.4999999999999997),     (16, 21, 0.07285427772641154), (16, 20, 0.4999999999999997), (17, 18, 1), (17, 19, 1),     (18, 15, 0.35429144454717726), (18, 16, 0.1457085554528229), (19, 16, 0.07285427772641144),     (19, 21, 0.28143716682076536), (19, 20, 0.42714572227358877), (20, 16, 1), (20, 19, 1), (20, 21, 1),      (21, 11, 1), (21, 16, 0.28143716682076536), (21, 20, 0.07285427772641145) ] G = nx.DiGraph() G.add_nodes_from(range(22)) G.add_weighted_edges_from(capacities, weight='capacity') s = 4 t = 5  def get_arc_cut(partition):     reachable, non_reachable = partition     arc_cut = set()     for u, nbrs in ((n, G[n]) for n in reachable):         arc_cut.update((u, w) for w in nbrs if w in non_reachable)     return arc_cut  ############################### value, partition = nx.minimum_cut(G, s, t) arc_cut = get_arc_cut(partition)  print(f'flow_value: {value}') print(f'cut_value:  {sum(G.edges[a]["capacity"] for a in arc_cut)}') print(f'arc_cut: {arc_cut}\n')  ################################ R = nx.algorithms.flow.preflow_push(G, s, t, capacity='capacity', value_only=True) residual_capacities = sorted((abs(d["flow"] - d["capacity"]),u,v) for u, v, d in R.edges(data=True)) cutset = [(u, v, d) for u, v, d in R.edges(data=True) if abs(d["flow"] - d["capacity"]) < 1e-10] R.remove_edges_from(cutset) non_reachable = set(dict(nx.shortest_path_length(R, target=t))) reachable = set(G) - non_reachable arc_cut = get_arc_cut((reachable, non_reachable))  print(f'flow_value: {R.graph["flow_value"]}') print(f'cut_value:  {sum(G.edges[a]["capacity"] for a in arc_cut)}') print(f'arc_cut: {arc_cut}\n')  print(f'residual capacities: {residual_capacities}') ```  Output is ``` flow_value: 0.9271457222735886 cut_value:  1.0 arc_cut: {(12, 6), (10, 6), (15, 3)}  flow_value: 0.9271457222735886 cut_value:  0.9271457222735886 arc_cut: {(0, 13), (1, 13), (6, 5)}  residual capacities: [(0, 0, 2), (0, 1, 2), (0.0, 1, 13), (0.0, 4, 17), (0.0, 10, 6), (0.0, 12, 6), (0.0, 12, 10), (0, 13, 2), (0, 14, 13), (0.0, 15, 3), (0.0, 16, 15), (0.0, 16, 18), (0.0, 19, 16), (0.0, 19, 20), (5.551115123125783e-17, 6, 5), (5.551115123125783e-17, 18, 15), (1.1102230246251565e-16, 0, 13), (0.0728542777264114, 7, 5), (0.0728542777264114, 8, 7), (0.0728542777264114, 9, 8), (0.07285427772641144, 16, 19), (0.07285427772641148, 6, 10), (0.07285427772641151, 1, 0), (0.13572861136794273, 19, 21), (0.14570855545282263, 21, 19), (0.1457085554528229, 16, 21), (0.1457085554528229, 18, 16), (0.14570855545282302, 3, 0), (0.14570855545282302, 13, 1), (0.14570855545282324, 21, 20), (0.208582889094354, 21, 16), (0.21856283317923442, 13, 9), (0.3542914445471772, 15, 18), (0.3542914445471772, 17, 19), (0.3542914445471772, 18, 17), (0.4999999999999997, 15, 16), (0.6457085554528228, 17, 18), (0.6457085554528228, 19, 17), (0.6457085554528231, 20, 16), (0.7085828890943542, 13, 0), (0.7571524075786283, 14, 9), (0.7814371668207655, 0, 1), (0.8542914445471765, 16, 20), (0.854291444547177, 0, 3), (0.854291444547177, 3, 15), (0.854291444547177, 11, 12), (0.854291444547177, 21, 11), (0.9271457222735882, 20, 21), (1, 2, 0), (1, 2, 1), (1, 2, 13), (1, 9, 14), (1, 13, 14), (1.0, 17, 4), (1.0728542777264114, 6, 12), (1.0728542777264114, 10, 12), (1.145708555452823, 5, 6), (1.145708555452823, 11, 21), (1.145708555452823, 12, 11), (1.4271457222735888, 20, 19), (1.7814371668207656, 5, 7), (1.7814371668207656, 7, 8), (1.7814371668207656, 8, 9), (1.7814371668207656, 9, 13)] ```   ### Environment Python version: 3.8 NetworkX version: 2.5  
