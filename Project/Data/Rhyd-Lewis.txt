issue
Additions and modifications to greedy_coloring and equitable_coloring#TITLE_END#Summary of changes. The following files have been changed. These are considered below, with further details  **…\networkx\networkx\algorithms\coloring\equitable_colouring.py**  As before, this new code provides an equitable k-colouring for the nodes of a graph G (where k is specified by the user via the parameter “num_colors”). The original version of this code only works when the number of colours k (defined by the user) exceeds the maximum degree of G. In our new version, a heuristic algorithm is added that is used in cases where k is *less* than this value. This allows more flexibility for users. This heuristic algorithm is described and documented in my book:  Lewis, R. (2021) A Guide to Graph Colouring: Algorithms and Applications, 2nd Ed. Springer, ISBN: 978-3-030-81053-5 https://link.springer.com/book/10.1007/978-3-030-81054-2.  The implementation of this new algorithm has complexity O((n log n) + (nk) + (m log m)). As required, in solutions returned by this method, neighbouring vertices always receive different colours; however, the colouring is not guaranteed to be equitable.  Several new exceptions have now also been added to this code to reflect these changes and to make the existing code safer.  - NetworkXAlgorithmError: If a value of k is used that is too small (that is, the heuristic algorithm is unable to colour all nodes of G such that neighbours always have different colours - NetworkXNotImplemente: If G is a directed graph or directed multigraph. - ValueError: If k is not a positive integer.       The documentation and comments have been modified to reflect these changes. All other parts of the code remain the same, albeit with some tidying.    **…\networkx\networkx\algorithms\coloring\greedy_colouring.py**  Updates have also been made to the above file to improve performance and simplify the methods used for graph colouring. The main changes are:  - the deletion of the existing “interchange” operator, and the addition of a new tabu search operator - the implementation of two high-performance constructive heuristics that are known to be exact on some topologies and produce good results on arbitrary graphs,  - an improvement in the documentation and more information of algorithm complexity. - Additional exceptions: in particular, these algorithms should not be used with directed graphs.  Full descriptions and analyses of these algorithms can also be found in my book:  Lewis, R. (2021) A Guide to Graph Colouring: Algorithms and Applications, 2nd Ed. Springer, ISBN: 978-3-030-81053-5 https://link.springer.com/book/10.1007/978-3-030-81054-2.  A concise description of the new tabu search algorithm is given in the comments/documentation. It is a well-regarded contemporary method that is known to produce results close to the state of the art. Here are its main benefits.  - The tabu search algorithm occupies fewer lines of code -- approximately 80 lines as opposed to interchange's 180. - The tabu search algorithm can be used as an additional step with all the greedy heuristics currently included in the NetworkX library. In contrast, the interchange method does not work with DSatur, despite this being one of the best available greedy heuristics. - The tabu search algorithm allows users to specify the maximum number of iterations. Better results (but longer run times) will occur with larger iteration limits. - Compared to all existing colouring methods in the NetworkX library, the tabu search option produces solutions with fewer colours than interchange, and in less time. The following document contains further details on this: https://www.rhydlewis.eu/gcol/analysis.pdf.  The second change we have made is in the implementation if the Dsatur algorithm in NetworkX, where there is currently a slight error. In the original specification of Dsatur (given in the following paper):  Brélaz, D. (1979). "New methods to color the vertices of a graph". Communications of the ACM. 22(4), pp. 251–256.  the next vertex to be coloured should be the one with the highest saturation degree, breaking ties by selecting the vertex with the *highest degree in the subgraph induced by the uncoloured vertices*. However, the current NetworkX implementation breaks ties by only looking at the degree of the vertex in the original graph. This fault is corrected in our proposed implementation. Our new implementation also makes use of a priority queue and has a complexity of O((n+m) lg(n+m)) as opposed to the existing implementation of O(n^2). This new implementation occupies fewer lines of code and is faster for all but the densest of graphs. A further analysis of this algorithm (performance and complexity) is available in the above book.  Finally, we have also added the famous recursive largest first (RLF) algorithm as an option for the greedy colouring method. This is a well-known and high-performing method that has a complexity of O(nm). This is slightly more expensive than the existing greedy methods, although it is also known to produce better quality solutions. (Information on this can also be seen in the above book and at https://www.rhydlewis.eu/gcol/analysis.pdf.)   **…\networkx\networkx\algorithms\coloring\tests\test_coloring.py**  In the above file, several new tests have been added to ensure our new code functions as expected. We can confirm that is correct. Additional information on run times and performance can also be seen in https://www.rhydlewis.eu/gcol/analysis.pdf  
