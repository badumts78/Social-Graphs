issue
d_separated and minimal_d_separator functions incorrectly handle non-disjoint sets and adjacent nodes#TITLE_END#See discussion post #6889  <!--- Provide a general summary of the issue in the Title above -->  ### Current Behavior  d-separation statements are returned even when the sets aren't disjoint, and adjacent nodes can be found to be d-separated  ### Expected Behavior an error should be raised when the sets given to `d_separated()` aren't disjoint and `minimal_d_separator()` should return something that clearly indicates no such separator exists (as opposed to an empty object, which should indicate that the nodes are d-separated given the empty set)  ### Steps to Reproduce  See discussion post #6889  ### Environment  Python version: 3.11.5 NetworkX version: 3.2rc0.dev0  ### Additional context See discussion post #6889 <!--- Add any other context about the problem here, screenshots, etc. --> 
issue
document graph type; add links; rm unused import#TITLE_END#I added documentation about the graph parameters of the algorithms, as mentioned in issue #6849 , and similarly for a few other community algorithms not mentioned there. I also fixed some reference links and removed one unused import statement.
comment
> >     * Couldn't you just take the union of the resulting separating set with `i` to make a separating set that includes `i`? >   It's a bit more complicated than that, because conditioning on nodes can open paths that would otherwise be blocked. For example, in the DAG `A -> B <- C -> D`, a minimal separating set between `A` and `D` is the empty set. If `i` is the singleton `{B}`, simply unioning that with the empty separating set renders `A` and `D` connected. Instead, the minimal separating set including `{B}` must be `{B, C}`. 
comment
Still not sure how/if it's possible for me to add my commits directly to this pull request (I only found the option to create a new one, which I guess is just more unneeded overhead), but [here's my fork of this PR with some added commits](https://github.com/Alex-Markham/networkx/tree/bug-6430-no-sep)  In particular, I've done the following: - renamed `u` and `v` to `x` and `y` to for consistency (I left `z` as is, but could easily rename it to `separator` if desired) - (also left it as `find_minimal_d_separator`, because that seems more appropriate than `separated`, since it's not just returning a boolean, but can easily change this if anyone insists) -  renamed `i` and `r` to `included` and `restricted` and added keyword-only indicators - adding a missing check for disjointness and removed one redundant check - updated docs accordingly - added `minimal_d_separated` to the tests that nondisjointness raises an error - wrote tests for `included` and `restricted`, and found a bug that needs more investigation---I'll have more time for that tomorrow if someone else doesn't get to it first
comment
It seems the code is still implementing the algorithm in [this paper](https://arxiv.org/abs/1803.00116) (and it's still failing the simple test I wrote, so the implementation or algorithm is wrong) instead of the paper mentioned in [this comment](https://github.com/networkx/networkx/pull/6438#issuecomment-1441113573). I can go through the new paper to implement that algorithm, but not might not have time for it until next week
comment
I like those proposed function signatures and think they're the right mix of descriptive, simple, and following established naming conventions in causality. I have correspondingly updated them and started implementing the newer algorithm (which is more involved than I anticipated, because it requires implementing a modified Bayes-ball algorithm to avoid the moral graphs used by the previous implementation). I hope to finish implementing/testing the new alg next week.
comment
@dschult alright, I finished implementing the new algorithm and have correspondingly updated `find_minimal_d_separator` and `is_minimal_d_separator` as well as their documentation and tests. [Here's the link again to my branch/fork](https://github.com/Alex-Markham/networkx/tree/bug-6430-no-sep). Let me know if there's anything else I can help with!  P.S.: I suppose something still needs to be done to document the deprecation, but I'm not sure exactly what to do (the contributor guide doesn't seem to cover this particular situation), so I either need more guidance or for someone else to handle that
comment
Yes, it fixed the simple tests I had in mind (which have all been added to `test_d_separation.py`) and fully implements the desired interface as far as I understood it.
comment
It seems this still doesn't fix the bugs described in  #6994   In particular, `G.add_edges_from([(0, 2), (1, 2)]); d_separated(G, 0, 2, 0)` still returns `True`
comment
Not sure how to add my commits to this pull request, but here are the changes I would make to [`d_separation.py`](https://github.com/jaron-lee/networkx/commit/c76e07a436f9d0c952108422fa4c2367823b08ea) and [`test_deseparation.py`](https://github.com/jaron-lee/networkx/commit/4ca5db154a003701bc2e48662fe9aa31c2c4949d)  (I started to turn these into a pull request but ran into problems because some of these commits are so behind `main` at this point, and I'm not confident that I was handling the rebase correctly---sorry. Hopefully the two links above are sufficient for someone with more experience to properly incorporate my suggestions into this pull request)
