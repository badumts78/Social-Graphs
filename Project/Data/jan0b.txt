issue
Can not compute Laplacian matrix of graph (neither undirected nor directed)#TITLE_END#<!-- If you have a general question about NetworkX, please use the discussions tab to create a new discussion -->  <!--- Provide a general summary of the issue in the Title above -->  ### Current Behavior I am trying to compute the laplacian matrix for a simple complete graph. When using  _nx.laplacian_matrix()_ or _nx.directed_laplacian_matrix()_ an error is thrown from the same location, due to a misfit of the matrix and offsets in the initialization of the scipy _dia_matrix_. Find the detailed error below. <!--- Tell us what happens instead of the expected behavior -->  ### Expected Behavior The expected behaviour is, that the laplacian is calculated normally. I achieved this by replacing: `DI = sp.sparse.csr_array(sp.sparse.spdiags(1.0 / A.sum(axis=1), 0, n, n))` with `DI = sp.sparse.csr_array(sp.sparse.spdiags(1.0 / A.sum(axis=1).T, 0, n, n))` in `networkx.linalg.laplacianmatrix._transition_matrix()` and `networkx.linalg.laplacianmatrix.laplacian_matrix()` respectively. But I am not sure, whether this is in line with the mathematical definition for calculating the laplacian matrix. I would apprecaite your help.  <!--- Tell us what should happen -->  ### Steps to Reproduce Here is a short code snippet, to reproduce the error:  ``` graph = nx.complete_graph(4) graph_dir = graph.to_directed()  nx.laplacian_matrix(graph) nx.directed_laplacian_matrix(graph_dir) ``` <!--- Provide a minimal example that reproduces the bug -->  ERROR message: ``` File ~/.conda/envs/<<>>/lib/python3.8/site-packages/networkx/utils/decorators.py:845, in argmap.__call__.<locals>.func(_argmap__wrapper, *args, **kwargs)     844 def func(*args, __wrapper=None, **kwargs): --> 845     return argmap._lazy_compile(__wrapper)(*args, **kwargs)  File <class 'networkx.utils.decorators.argmap'> compilation 50:4, in argmap_laplacian_matrix_47(G, nodelist, weight)       2 import collections       3 import gzip ----> 4 import inspect       5 import itertools       6 import re  File ~/.conda/envs/<<>>/lib/python3.8/site-packages/networkx/linalg/laplacianmatrix.py:58, in laplacian_matrix(G, nodelist, weight)      56 n, m = A.shape      57 # TODO: rm csr_array wrapper when spdiags can produce arrays ---> 58 D = sp.sparse.csr_array(sp.sparse.spdiags(A.sum(axis=1), 0, m, n, format="csr"))      59 import warnings      61 warnings.warn(      62     "laplacian_matrix will return a scipy.sparse array instead of a matrix in Networkx 3.0.",      63     FutureWarning,      64     stacklevel=2,      65 )  File ~/.conda/envs/<<>>/lib/python3.8/site-packages/scipy/sparse/construct.py:60, in spdiags(data, diags, m, n, format)      25 def spdiags(data, diags, m, n, format=None):      26     """      27     Return a sparse matrix from diagonals.      28     (...)      58       59     """ ---> 60     return dia_matrix((data, diags), shape=(m,n)).asformat(format)  File ~/.conda/envs/<<>>/lib/python3.8/site-packages/scipy/sparse/dia.py:152, in dia_matrix.__init__(self, arg1, shape, dtype, copy)     149     raise ValueError('data array must have rank 2')     151 if self.data.shape[0] != len(self.offsets): --> 152     raise ValueError('number of diagonals (%d) '     153             'does not match the number of offsets (%d)'     154             % (self.data.shape[0], len(self.offsets)))     156 if len(np.unique(self.offsets)) != len(self.offsets):     157     raise ValueError('offset array contains duplicate values')  ValueError: number of diagonals (4) does not match the number of offsets (1) ```   ### Environment  <!--- Please provide details about your local environment -->  Python version: 3.8.13 NetworkX version: 2.8.4 with conda  ### Additional context  <!--- Add any other context about the problem here, screenshots, etc. --> 
