issue
cycle_basis problem#TITLE_END#Hello there,  thank you for all your work on networkx - it's helping a great deal in my phd!  To cut a long story short, I stumbled across some instances where nx.cycle_basis() was giving me basis cycles which didn't seem right (it works most of the time).  I had a look though this github to see if others had seen this problem, and if it had been resolved, but I couldn't see anything.  For example, for this graph:  ![figure_6966443](https://cloud.githubusercontent.com/assets/5628136/5518421/0c337b0c-891f-11e4-97fa-c339ab305692.png)  I get this array returned: [[3, 5, 1], [3, 9, 6, 5], [4, 8, 9, 6, 5, 1], [3, 4, 1]]  The array [4, 8, 9, 6, 5, 1] isn't a basis cycle and the basis cycle [3, 9, 8, 4] is missing.  I had a look at the underlying code, which I took from this webpage - http://networkx.lanl.gov/_modules/networkx/algorithms/cycles.html#cycle_basis.  It looks like the code searches in a way which, for the above graph, meant that [4, 8, 9, 6, 5, 1] was 'found' before [3, 9, 8, 4] was found; and nodes were removed from 'gnodes' before  [3, 9, 8, 4] could be found at all.  To replicate this problem, consider the following code (which replicates the above graph via its adjacency matrix and uses the code above):  ``` python  def cycle_basis(root=None):      Adj_Matrix = np.array([[0, 0, 0, 0, 0, 0, 0, 0, 0, 0],  # 0                            [0, 0, 1, 1, 1, 1, 0, 0, 0, 0],  # 1                            [0, 1, 0, 0, 0, 0, 0, 0, 0, 0],  # 2                            [0, 1, 0, 0, 1, 1, 0, 0, 0, 1],  # 3                            [0, 1, 0, 1, 0, 0, 0, 0, 1, 0],  # 4                            [0, 1, 0, 1, 0, 0, 1, 0, 0, 0],  # 5                            [0, 0, 0, 0, 0, 1, 0, 0, 0, 1],  # 6                            [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],  # 7                            [0, 0, 0, 0, 1, 0, 0, 0, 0, 1],  # 8                            [0, 0, 0, 1, 0, 0, 1, 0, 1, 0]]) # 9     G = nx.from_numpy_matrix(Adj_Matrix)     gnodes=set(G.nodes())     cycles=[]     while gnodes:  # loop over connected components         if root is None:             root=gnodes.pop()         stack=[root]         pred={root:root}          used={root:set()}         while stack:  # walk the spanning tree finding cycles             z=stack.pop()  # use last-in so cycles easier to find             zused=used[z]             for nbr in G[z]:                 if nbr not in used:   # new node                      pred[nbr]=z                     stack.append(nbr)                     used[nbr]=set([z])                 elif nbr is z:        # self loops                     cycles.append([z])                  elif nbr not in zused:# found a cycle                     pn=used[nbr]                     cycle=[nbr,z]                     p=pred[z]                     while p not in pn:                         cycle.append(p)                         p=pred[p]                     cycle.append(p)                     cycles.append(cycle)                     used[nbr].add(z)         gnodes-=set(pred)         root=None     return cycles ```  Has anyone ever raised this before?  I am using Python v2.7 via Anaconda on a mac and uploaded networkx about 2 months ago.  I might have a look to see if I can develop the code to make it work all of the time but, for now, I thought I'd raise this issue.  Best wishes,  Greg Fisher 
