comment
Hi. I worked with Sam Johnson, who wrote the paper at [1]. I've got some python code for this already, including tests and everything. @tomalrussell  I will take a look at your code and make some suggestions over the next few days. In particular I think you will need to be careful if the directed graph has no basal node (e.g. a complete graph), I'm not sure but I think that this line will raise an error:  >  n = np.linalg.inv(i - q)
comment
Hey   I started adding in some tests and found one that failed. I think we might need to look at the main function again? I can take a look tomorrow I think, or in the next few days anyway. Definitely need to add something to avoid it raising an error if no basal nodes (no nodes with zero in-degree).   I've also got code to calculate trophic coherence, with tests, so we can add that too.   I've added a pull request to your code @tomalrussell here https://github.com/tomalrussell/networkx/pull/1   ![IMG_20191203_154000](https://user-images.githubusercontent.com/6584368/70067614-6fc40480-15e6-11ea-922f-485157ca91ff.jpg)
comment
Hey @tomalrussell - yes it would be great to collaborate. Thanks for your reply.   With no basal nodes trophic level isn't defined in at least come cases. For example if you have a cycle of three nodes then there is no solution to the basic trophic level equation - because each node needs a higher trophic level than it's child. That's why the linear equation breaks.  The work I did before was considering graphs without weighted edges. The trophic level calculation involves creating a weighted graph from that, so that like you said the weights of incoming edges sum to one. We're in the process of submitting a paper on it, https://arxiv.org/abs/1909.12603. The Appendix (part A) has a nice derivation of the trophic level calculation.  Like I said I also have code to calculate trophic coherence, as well as the general preferential preying model (introduced in Johnson's paper), so we can add that as well once we have the trophic level function sorted. I'll add in some more tests tomorrow, then we can get the function to pass them all. 
