issue
Make PyDot Support Great Again#TITLE_END#This pull request refactors the `networkx.drawing.nx_pydot` submodule to support the well-maintained [`pydot`](https://github.com/erocarrera/pydot) project in lieu of the effectively dead [`pydotplus`](https://github.com/carlos-jenkins/pydotplus) fork, resolving [issue #2235](https://github.com/networkx/networkx/issues/2235) (_Abandon All pydotplus, Ye Who Graph Here_) and restoring basic sanity.  See #2235 for full-frontal details. A brute-force **tl;dr** follows: - The last commit for [`pydotplus`](https://github.com/carlos-jenkins/pydotplus) was at **[December 8th, 2014](https://github.com/carlos-jenkins/pydotplus/commits/master?page=1)** â€“ nearly two years ago. Long-standing open issues and pull requests remain unresolved. `pydotplus` is a face-rotting zombie. - The last commit for [`pydot`](https://github.com/erocarrera/pydot) was at **[July 2nd, 2016](https://github.com/erocarrera/pydot/commits/master)** â€“ only a little over two months ago. Issues and pull requests are quickly dispatched with, as evidenced by a [closed issue](https://github.com/erocarrera/pydot/issues/133) I foolishly opened two days ago.  **`pydot` lives.** ## Not all that Glitters is PyDot Gold  `pydot` 1.2.0 recently broke [backward API compatibility](https://github.com/erocarrera/pydot/blob/master/ChangeLog) with pre-1.0.29 forks (like `pydotplus`) in mostly beneficial ways. Let's talk a bit about that. ### Dot File Deserialization Gone Wild  In `pydot` 1.2.0, the `pydot.graph_from_dot_data()` function now _unconditionally_ returns a list of all deserialized `pydot.Dot` objects rather than _conditionally_ returning a list if the passed data contains two or more graphs or a single `pydot.Dot` object otherwise.  This is a positive change. The prior approach complicated caller handling and encouraged caller errors. It didn't help that the prior approach was poorly documented and that everyone downstream made simplistic assumptions about that approach. How do we know this?  Because NetworkX currently assumes the `pydot.graph_from_dot_data()` function to _always_ return a single `pydot.Dot` object. Which was never the case. Maybe nobody cares about `pydot` integration with dot files containing multiple graphs? It is pretty edge-case. <sup>_Or maybe my tenuous deathgrip on sanity has slipped another notch lower._</sup>  NetworkX functionality calling the `pydot.graph_from_dot_data()` function includes: - `networkx.drawing.nx_pydot.read_dot()`. - `networkx.drawing.nx_pydot.pydot_layout()`. - `networkx.drawing.tests.test_pydot.TestPydot.pydot_checks()`.  This functionality has all been refactored to accept lists of `pydot.Dot` objects. In the case of both `pydot_layout()` and `pydot_checks()`, a list of exactly one object is _always_ returned. Life is simple here.  In the case of `read_dot()`, however, a list of two or more objects are returned if the passed dot file contains two or more graphs. This was _always_ the case, of course. NetworkX currently ignores this discrepancy by returning "sight-unseen" whatever `pydot` returns _without_ documenting that a list of graphs rather than a single graph might be returned.  Two options exist here: 1. **Break NetworkX backwards compatibility.** Refactor `read_dot()` to unconditionally return a list of `pydot.Dot` objects â€“ just like the underlying `pydot.graph_from_dot_data()`. Orthogonality is preserved, which is mildly good. All downstream logic is broken, which is strongly bad. 2. **Mostly preserve NetworkX backwards compatibility.** Refactor `read_dot()` to unconditionally return only a single `pydot.Dot` object if the passed dot file contains only one graph _or_ raise an exception otherwise.  Under the safe assumption that 99.9999% of all calls to `read_dot()` pass dot files containing only one graph, the latter _"Don't break everything!"_ approach is arguably the sane approach. I like sanity, so I went with that.   If anyone ever requires deserialization of multiple `pydot.Dot` objects from a single dot file, subsequently adding a new NetworkX function (e.g., `read_dots()`) _or_ a new optional keyword argument to the existing `read_dot()` function (e.g., `return_list=False`) would be trivial. This is left as an exercise to the reader. ### String Decoding and What It Can Do for You  In `pydot` 1.2.0,<sup>..._maybe earlier?_</sup> the `pydot.Dot.create_dot()` method now returns an encoded byte array (`bytes` in Python 3) rather than a probably-incorrectly-decoded Unicode string (`str` in Python 3).  This is a positive change, too. The prior approach masked inevitable encoding errors with a Jedi handwave: _"These are the character-like bytes you might be looking for. No further questions!"_  This does require, however, that NetworkX functionality calling `create_dot()` explicitly decode its return value into a proper Unicode string. My simplistic assumption is that GraphViz encodes this return value via the current user's preferred locale (e.g., `LC_*` environment variables on POSIX-compatible platforms), which is safely decodable by NetworkX via the same encoding. This assumption appears to hold. May the [Spaghetti Monster](https://s-media-cache-ak0.pinimg.com/564x/66/68/18/6668181a59aaf6846cfcb90f2a780e18.jpg) preserve us all.  The `pydot.Dot.create_dot()` method is only called by the `networkx.drawing.nx_pydot.pydot_layout()`,  which has been refactored to decode the returned byte array via the current `locale.getpreferredencoding()`. <sup>..._which is probably just `utf-8`, in most cases._</sup> ## We Can Build a Better PyDot Integration  The newer 1.2.0 `pydot` API is a non-trivial departure from the older pre-1.0.29 `pydot` API. Since both cannot be reasonably supported at the same time, this pull request revises all `networkx.drawing.nx_pydot` functions to explicitly require `pydot >= 1.2.0`. To enforce this constraint in a human-readable manner: - A new private `networkx.drawing.nx_pydot._import_pydot()` function has been defined, importing and returning the `pydot` module if the currently installed version of that module is `>= 1.2.0` _or_ raising an `ImportError` exception. For [robustness](https://stackoverflow.com/a/21065570/2809027), the ubiquitous `pkg_resources.parse_version()` function  is called to implement this version comparison. Since NetworkX requires setuptools at installation time, the setuptools-bundled `pkg_resources` package is assumed to be available at runtime. This assumption is almost certainly safe for most definitions of "almost," "certainly," and "safe." - Most `import pydotplus` statements in the codebase now read `pydot = _import_pydot()`. ## Are You Quite Done Yet?  **Nope.** Unit tests have also been improved to explicitly test the `networkx.drawing.nx_pydot.pydot_layout()` function. Because this is a safety-first pull request. For maintainability, I also obsessively documented everything in these tests. Because obsessiveness.  Thanks for the hard volunteerism, fellow NetworkX-ers! This graph paper is for you. :chart_with_upwards_trend:  
issue
Interim 1.12 Release â€“ Can It Be?#TITLE_END#Thanks for all the graph, NetworkX. Sadly, time waits for no coder.  It's been well over a year since the [last stable release](https://github.com/networkx/networkx/releases) (1.11). NetworkX's release schedule had been quite proactive up until that inexplicable roadblock, with most pre-1.11 releases tagged within several months of the prior release. For... _reasons_, post-1.11 development fully stalled out and has failed to release a stable version since then.  The **[NetworkX 2.0](https://github.com/networkx/networkx/projects/2)** project page suggests 10 pull requests require review and 11 outstanding issues require pull requests... *that don't exist yet.* It's the latter dependency that concerns me.  I'd love for NetworkX 2.0 to happen tomorrow. It's pretty self-evident that it's not, though â€“ which is probably a good thing. All good things come to those who patiently post issues, integrate NetworkX into downstream applications, and endlessly bicker on [/r/Python](https://www.reddit.com/r/Python). <sup>_Maybe not that last one._</sup>  In the interests of opening up this massive changeset to a larger QA audience and incrementally creeping up to the congratulatory fireworks of 2.0, would an interim pre-2.0 release be feasible? Say, either a stable 1.12 release *or* an unstable 1.99 pre-release *or* **[**`insert good idea here`**]**?  If not, that's cool. It's just been *soooo* long. You know? Sad face. ðŸ˜‚ 
issue
Abandon All pydotplus, Ye Who Graph Here#TITLE_END#NetworkX 1.11 unilaterally [dropped support](https://github.com/networkx/networkx/pull/1924) for**[`pydot`](https://github.com/erocarrera/pydot)**in favour of**[`pydotplus`](https://github.com/carlos-jenkins/pydotplus)**â€“ breaking backward compatibility with upstream projects requiring the former.  Breaking backward compatibility isn't _necessarily_ a problem per se. Sometimes you gotta [crack the world's shell](https://www.youtube.com/watch?v=McKR0IgCM34) in order to make a tender omelette worthy of Iron Chef. :egg:   Dropping support for the _only_ well-maintained pure-Python GraphViz library (`pydot`) in favour of its worst-maintained alternative (`pydotplus`) smells like a rotting wound waiting to fester, however. ## Then There Were Three  There are three `pydot`-like projects. In order of increasing commit and release activity, these are: 1. **[`pydotplus`](https://github.com/carlos-jenkins/pydotplus),** a `pydot` fork circa 2007. `pydotplus` is moribund, on life support, and effectively dead â€“ and has been for nearly two years. It lasted seven glorious years before unceremoniously kicking the bit bucket. Only the good forks die young. This fork's:    - [Last commit](https://github.com/carlos-jenkins/pydotplus/commits/master?page=1) was at **December 8th, 2014.**     - [Last stable release](https://pypi.python.org/pypi/pydotplus) was at **December 9th, 2014.** 2. **[`pydot-ng`](https://github.com/pydot/pydot-ng),** yet _another_ `pydot` fork also circa 2007. `pydot-ng` is _also_ moribund, on life support, and effectively dead â€“ and has been for nearly a year. It lasted eight glorious years and then silently fell into a [sarlacc pit](https://www.youtube.com/watch?v=oezZTXzXs90), one-upping `pydotplus` by several months. All forks succumb to GitHub winter, in the end. This fork's:    - [Last commit](https://github.com/pydot/pydot-ng/commits/master) was at **March 15th, 2015.**     - [Last stable release](https://pypi.python.org/pypi/pydot-ng) was at **February 26th, 2015.** 3. **[`pydot`](https://github.com/erocarrera/pydot),** the canonical `pydot` project with over 100 commits spanning nearly a decade. Unlike its now-disabled rivals, `pydot` remains highly active, responsive to issue submissions and pull requests, and dedicated to the cause of righteousness. Recent codebase improvements include [Travis](https://github.com/erocarrera/pydot/blob/master/.travis.yml)-based continuous integration (CI), Python 3-oriented [optimizations](https://github.com/erocarrera/pydot/commit/9b3c1a1d1101fd8523c0efbb9a1b3997a914e5a2), improved [unicode handling](https://github.com/erocarrera/pydot/commit/5df24ff318bcc73e92f9531c2ed37678268b8beb), improved [PEP8 compliance](https://github.com/erocarrera/pydot/commit/0d023928f42f1448eedfb9d2c46165e1d221c46e), improved [setuptools integration](https://github.com/erocarrera/pydot/commit/69dce474f6fbcaa6055586611453e43f3f20230d), and the list just exhaustively goes _on and on_.    This project's:    - [Last commit](https://github.com/erocarrera/pydot/commits/master) and [last stable release](https://pypi.python.org/pypi/pydot) were both at **July 2nd, 2016.**  It's _not_ simply activity, however. It's availability: - The cross-platform Anaconda distribution officially supports both the Python 2.x and 3.x versions of both [`pydot`](https://anaconda.org/anaconda/pydot) and [`pydot-ng`](https://anaconda.org/anaconda/pydot-ng). Isn't that nice? By compare:   - The Python 2.x and 3.x versions of `pydotplus` are only [unofficially supported](https://anaconda.org/conda-forge/pydotplus) via a [third-party `conda` forge](https://github.com/conda-forge/pydotplus-feedstock). - Ubuntu has officially supported the Python 2.x version of `pydot` since [Precise (12.04)](http://packages.ubuntu.com/search?keywords=python-pydot) and the Python 3.x version of `pydot` since [Wily (15.10)](http://packages.ubuntu.com/search?keywords=python3-pydot). By compare:   - The Python 2.x but _not_ 3.x version of `pydot-ng` has been officially supported since [Wily (15.10)](http://packages.ubuntu.com/search?keywords=python-pydot-ng).   - The Python 2.x and 3.x versions of `pydotplus` will only be officially supported as of the yet-unreleased [Yakkety (16.10)](https://launchpad.net/ubuntu/+source/python-pydotplus). - Arch Linux [officially supports](https://packages.gentoo.org/packages/media-gfx/pydot) both the Python 2.x and 3.x versions of `pydot`. By compare:   - The Python 2.x and 3.x versions of `pydot-ng` are [unofficially supported](https://aur.archlinux.org/packages/python-pydot-ng) via the Arch User Repository (AUR).   - `pydotplus` remains unsupported, both officially and otherwise. - Gentoo Linux [officially supports](https://packages.gentoo.org/packages/media-gfx/pydot) the Python 2.x version of `pydot`. I'm contemplating adding unofficial support for the Python 3.x version via my [third-party overlay](https://github.com/leycec/raiagent). <sup>_Time, what is time?_</sup> By compare:   - `pydot-ng` remains unsupported, both officially and otherwise.   - The Python 2.x and 3.x versions of `pydotplus` are only unofficially supported via a [third-party overlay](https://github.com/gentoo-science/sci/tree/master/dev-python/pydotplus). - The OS X-specific:   - MacPorts package manager [officially supports](https://trac.macports.org/browser/trunk/dports/python/py-pydot/Portfile) the Python 2.x version of `pydot`. A port for the Python 3.x version has been [submitted](https://trac.macports.org/ticket/46509) but remains in ticket limbo. By compare:     - `pydot-ng` remains unsupported, both officially and otherwise.     - `pydotplus` remains unsupported, both officially and otherwise.   - Homebrew package manager supports _no_ `pydot`-like library. <sup>_Thanks alot, beer._</sup>  A suspicious pattern emerges. ## Then There Was One  In the endless circle game of unpaid GitHub volunteerism, he who is willing to do hard stuff for free wins. **`pydot` wins.** `pydotplus` and `pydot-ng` lose because they are dead. Can't complain. Had their chance and, in modern parlance, "blew it."  May the dark days ahead be leavened with wisdom, clarity, and developer omniscience. The dawn of a NetworkX-graphed Age beckons.  > <sup>I have no dead horse in this race. I'm a perfectly impartial bystander unaffiliated with any `pydot`-like project. I do this solely for the glory and continued longevity of NetworkX.</sup> 
