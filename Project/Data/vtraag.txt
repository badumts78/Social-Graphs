comment
> Are you able to give a description of why this queue is expected to eventually empty? It seems like it'd be easy to get into an oscillation where nodes are shifting labels back and forth repeatedly -- and each time they change they'd be adding their neighbors to the queue.  The continuous oscillation back and forth will eventually die out with probability tending to 1. That is, a new label will always be sampled from the maximum labels. There is hence always a non-zero probability that the same maximum label will be chosen, and that hence the label will not change. In that case, no neighbours of that node will be added to the queue. The same reasoning applies to all such possibly oscillating nodes, and so the algorithm is in fact guaranteed to stop. In theory, this can take a long time (with ever decreasing probability), but in practice this is hardly noticeable.
