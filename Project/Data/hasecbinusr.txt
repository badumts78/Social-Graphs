issue
Closed line draws as edge of no length; breaks graph.py at add_edges_from()#TITLE_END#Attempted to read a shapefile of OSM road data with the following code: ````python G=nx.read_shp('Test/Roads_Only_NoUnclass.shp') pos = {k: v for k,v in enumerate(G.nodes())} X=nx.Graph() #Empty graph X.add_nodes_from(pos.keys()) #Add nodes preserving coordinates l=[set(x) for x in G.edges()] #To speed things up in case of large objects edg=[tuple(k for k,v in pos.items() if v in sl) for sl in l] #Map the G.edges start and endpoints onto pos nx.draw_networkx_nodes(X,pos,node_size=1,node_color='r') X.add_edges_from(edg) nx.draw_networkx_edges(X,pos) plt.xlim(1399000, 1471300) #This changes and is problem specific plt.ylim(883800, 947800) #This changes and is problem specific plt.xlabel('Longitude') plt.ylabel('Latitude') plt.title('From shapefiles to NetworkX') ```` This resulted in the following error: ````python --------------------------------------------------------------------------- NetworkXError                             Traceback (most recent call last) <ipython-input-33-fd234537f6bd> in <module>()       6 edg=[tuple(k for k,v in pos.items() if v in sl) for sl in l] #Map the G.edges start and endpoints onto pos       7 nx.draw_networkx_nodes(X,pos,node_size=1,node_color='r') ----> 8 X.add_edges_from(edg)       9 nx.draw_networkx_edges(X,pos)      10 plt.xlim(1399000, 1471300) #This changes and is problem specific  ...\networkx\classes\graph.py in add_edges_from(self, ebunch, attr_dict, **attr)     863             else:     864                 raise NetworkXError( --> 865                     "Edge tuple %s must be a 2-tuple or 3-tuple." % (e,))     866             if u not in self.node:     867                 self.adj[u] = self.adjlist_dict_factory()  NetworkXError: Edge tuple (946,) must be a 2-tuple or 3-tuple. ```` Some error tracing revealed that closed lines have the same start point and end point, resulting in a 1-tuple in `G.edges()`: ![ringexample](https://cloud.githubusercontent.com/assets/26094353/25021048/63ccec1a-2056-11e7-9dc9-45729da6ffdb.png)  ````python ... {(1406536.6150999963, 889657.0859999992), (1406483.8554999977, 889674.7773000002)} {(1456536.862300001, 889682.3059)}  # Red node above {(1457006.9228999987, 889683.0931999981), (1456907.8184999973, 889655.3469999991)} ... ```` 1-tuple is created in `read_shp()` at line 94: ````python 93                    e1, e2, attr = edge 94                    net.add_edge(e1, e2) 95                    net[e1][e2].update(attr) ```` Perhaps the following change to ignore these rings? ```diff                     e1, e2, attr = edge +                   if e1 != e2:  # make sure we don't create a null-length edge +                       net.add_edge(e1, e2) +                       net[e1][e2].update(attr) -                   net.add_edge(e1, e2) -                   net[e1][e2].update(attr) ```
